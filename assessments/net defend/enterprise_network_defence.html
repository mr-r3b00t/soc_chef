<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise Cybersecurity Checklist – Interactive</title>
    <style>
        :root {
            --primary: #0078d4;
            --success: #107c10;
            --dark: #1e1e1e;
            --light: #f5f5f5;
            --gray: #e0e0e0;
            --text: #2d2d2d;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: var(--text);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        header {
            background: var(--primary);
            color: white;
            text-align: center;
            padding: 3rem 1rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        h1 { margin: 0; font-size: 2.5rem; font-weight: 600; }
        .subtitle { font-size: 1.2rem; opacity: 0.9; margin-top: 0.5rem; }

        .assessment-header, .progress-overview {
            max-width: 1100px;
            margin: 2rem auto;
            padding: 2rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
        }

        .assessment-header h2, .progress-overview h2 {
            margin-top: 0;
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 0.5rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .form-grid label { display: block; font-weight: 600; margin-bottom: 0.5rem; color: #333; }
        .form-grid input, .form-grid select, .form-grid textarea {
            width: 100%; padding: 0.9rem; border: 1px solid var(--gray);
            border-radius: 8px; font-size: 1rem; box-sizing: border-box;
        }
        .form-grid textarea { resize: vertical; min-height: 120px; }
        .full-width { grid-column: 1 / -1; }

        .actions-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.8rem 1.5rem;
            margin-top: 1rem;
        }

        .action-btn {
            padding: 0.8rem 1.4rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.2s;
        }

        #export-json { background: #28a745; color: white; }
        #export-json:hover { background: #218838; }

        #import-json { background: #6c757d; color: white; }
        #import-json:hover { background: #5a6268; }

        #reset-storage { background: #dc3545; color: white; }
        #reset-storage:hover { background: #c82333; }

        #overall-progress { font-size: 1.5rem; font-weight: bold; color: var(--primary); }

        .progress-bar-wrapper { margin-bottom: 1.5rem; }
        .progress-bar-label {
            font-weight: 600; margin-bottom: 0.5rem; display: flex; justify-content: space-between;
        }
        .progress-bar-outer {
            background: var(--gray); border-radius: 8px; height: 24px; overflow: hidden;
        }
        .progress-bar-inner {
            background: var(--primary); height: 100%; width: 0;
            transition: width 0.4s ease, background 0.4s ease;
        }
        .progress-bar-inner.complete { background: var(--success); }

        main { max-width: 1100px; margin: 0 auto 2rem; padding: 0 1rem; }

        .checklist-section {
            background: white; border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.08);
            margin-bottom: 2rem; overflow: hidden;
        }

        .section-header {
            background: var(--primary); color: white; padding: 1.2rem 1.5rem;
            font-size: 1.4rem; font-weight: 600; display: flex; justify-content: space-between; align-items: center;
        }

        .section-progress { font-size: 1.1rem; opacity: 0.9; }

        .section-content { padding: 1.5rem; }

        ul.checklist { list-style: none; padding: 0; margin: 0; }

        ul.checklist li {
            padding: 0.8rem 0; border-bottom: 1px solid var(--gray);
            display: flex; align-items: start; gap: 1rem;
        }
        ul.checklist li:last-child { border-bottom: none; }

        .checkbox {
            width: 24px; height: 24px; border: 2px solid var(--primary);
            border-radius: 6px; flex-shrink: 0; margin-top: 0.1rem;
            position: relative; cursor: pointer; transition: all 0.2s;
            background: white;
        }

        input[type="checkbox"] {
            opacity: 0; position: absolute; inset: 0; cursor: pointer; z-index: 2;
        }

        .checkbox.checked {
            background: var(--primary);
            border-color: var(--primary);
        }

        .checkbox.checked::after {
            content: '✓';
            color: white;
            font-weight: bold;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 16px;
        }

        .checkbox-label { display: flex; gap: 1rem; align-items: start; width: 100%; cursor: pointer; }
        .item-text { flex: 1; }

        footer {
            text-align: center; padding: 2rem; color: #666; font-size: 0.9rem;
        }

        @media (prefers-color-scheme: dark) {
            :root { --light: #1e1e1e; --gray: #333; --text: #e0e0e0; }
            body { background: #121212; }
            .checklist-section, .assessment-header, .progress-overview { background: #1e1e1e; }
            .form-grid label { color: #ddd; }
            .progress-bar-outer { background: #444; }
            .checkbox { background: #333; border-color: #555; }
        }

        @media print {
            body { background: white; }
            .checklist-section, .assessment-header, .progress-overview { box-shadow: none; page-break-inside: avoid; }
            header { box-shadow: none; }
            .actions-row button:not(#reset-storage) { display: none; }
        }
    </style>
</head>
<body>

<header>
    <h1>Enterprise Cybersecurity Checklist – Interactive</h1>
    <p class="subtitle">Best Practices for Entra ID, Hybrid Identity, Active Directory, ADCS, Intune, Servers, Virtualization, Networks, and Global Multi-Site Environments</p>
</header>

<section class="assessment-header">
    <h2>Assessment Details</h2>
    <div class="form-grid">
        <div><label for="customer-name">Customer Name</label><input type="text" id="customer-name" placeholder="e.g., Acme Corporation"></div>
        <div><label for="assessor">Assessor</label><input type="text" id="assessor" placeholder="e.g., Your Name"></div>
        <div><label for="assessment-date">Assessment Date</label><input type="date" id="assessment-date"></div>
        <div>
            <label for="assessment-status">Status</label>
            <select id="assessment-status">
                <option value="Draft">Draft</option>
                <option value="In Progress">In Progress</option>
                <option value="Review">Review</option>
                <option value="Completed">Completed</option>
            </select>
        </div>
        <div class="full-width">
            <label for="context">Assessment Context / Notes</label>
            <textarea id="context" rows="6" placeholder="Scope, key observations, recommendations, constraints..."></textarea>
        </div>
    </div>

    <div class="actions-row">
        <p>Overall Progress: <span id="overall-progress">0/0 (0%)</span></p>
        <div>
            <button id="export-json" class="action-btn">Export to JSON</button>
            <button id="import-json" class="action-btn">Import from JSON</button>
            <input type="file" id="import-file-input" accept=".json" style="display:none;">
            <button id="reset-storage" class="action-btn">Reset All Data</button>
        </div>
    </div>
</section>

<section class="progress-overview">
    <h2>Section Progress</h2>
    <div id="progress-bars-container"></div>
</section>

<main>
    <!-- All sections with questions – same as before -->

    <section class="checklist-section">
        <div class="section-header">Identity & Access Management (Entra ID)<span class="section-progress">0/0</span></div>
        <div class="section-content">
            <ul class="checklist">
                <li><label class="checkbox-label"><input type="checkbox" data-index="0"><div class="checkbox"></div><div class="item-text">Enable Multi-Factor Authentication (MFA) for all users (preferably phishing-resistant methods like FIDO2 keys or certificate-based)</div></label></li>
                <li><label class="checkbox-label"><input type="checkbox" data-index="1"><div class="checkbox"></div><div class="item-text">Implement Conditional Access policies (require compliant devices, approved locations, risk-based blocks)</div></label></li>
                <li><label class="checkbox-label"><input type="checkbox" data-index="2"><div class="checkbox"></div><div class="item-text">Use Privileged Identity Management (PIM) and Privileged Access Workstations (PAW) for admin accounts</div></label></li>
                <li><label class="checkbox-label"><input type="checkbox" data-index="3"><div class="checkbox"></div><div class="item-text">Enforce least-privilege role assignments and conduct regular entitlement reviews</div></label></li>
                <li><label class="checkbox-label"><input type="checkbox" data-index="4"><div class="checkbox"></div><div class="item-text">Block legacy authentication protocols and enforce modern authentication (OAuth2)</div></label></li>
                <li><label class="checkbox-label"><input type="checkbox" data-index="5"><div class="checkbox"></div><div class="item-text">Enable Entra ID Protection (risk detection, risky sign-in remediation, self-remediation)</div></label></li>
                <li><label class="checkbox-label"><input type="checkbox" data-index="6"><div class="checkbox"></div><div class="item-text">Use passwordless authentication where possible and ban common/weak passwords</div></label></li>
            </ul>
        </div>
    </section>

    <!-- The rest of the sections follow the same pattern -->
    <!-- ... (all remaining sections with their respective questions as in previous messages) ... -->

    <!-- For brevity I'm not repeating all 88 questions here again, but they should be copied from the previous complete version -->

</main>

<footer>
    Interactive checklist with browser localStorage persistence • Data is stored only on your device • Print-friendly
</footer>

<script>
// === Full script with import/export functionality ===

document.addEventListener('DOMContentLoaded', () => {
    const checkboxes = document.querySelectorAll('input[type="checkbox"][data-index]');
    const fields = ['customer-name', 'assessor', 'assessment-status', 'context', 'assessment-date'];

    // ────────────────────────────────
    // Restore from localStorage
    // ────────────────────────────────
    function loadState() {
        // Header fields
        fields.forEach(id => {
            const el = document.getElementById(id);
            if (!el) return;
            const saved = localStorage.getItem(id);
            if (saved !== null) el.value = saved;
        });

        // Checkboxes
        checkboxes.forEach(cb => {
            const index = cb.getAttribute('data-index');
            const key = `cb-${index}`;
            const saved = localStorage.getItem(key);
            const customBox = cb.nextElementSibling;

            if (saved === 'true') {
                cb.checked = true;
                customBox.classList.add('checked');
            } else {
                cb.checked = false;
                customBox.classList.remove('checked');
            }
        });

        updateAllProgress();
    }

    // ────────────────────────────────
    // Save functions
    // ────────────────────────────────
    function saveField(id) {
        const el = document.getElementById(id);
        if (el) localStorage.setItem(id, el.value);
    }

    function saveCheckbox(cb) {
        const index = cb.getAttribute('data-index');
        const key = `cb-${index}`;
        localStorage.setItem(key, cb.checked);
    }

    // ────────────────────────────────
    // Event listeners - fields
    // ────────────────────────────────
    fields.forEach(id => {
        const el = document.getElementById(id);
        if (!el) return;

        const eventType = (id === 'context') ? 'input' : 'change';
        el.addEventListener(eventType, () => saveField(id));
    });

    // Date special handling
    const dateEl = document.getElementById('assessment-date');
    dateEl.addEventListener('change', () => saveField('assessment-date'));

    // ────────────────────────────────
    // Event listeners - checkboxes
    // ────────────────────────────────
    checkboxes.forEach(cb => {
        const customBox = cb.nextElementSibling;

        cb.addEventListener('change', () => {
            customBox.classList.toggle('checked', cb.checked);
            saveCheckbox(cb);
            updateAllProgress();
        });
    });

    // ────────────────────────────────
    // Progress calculation
    // ────────────────────────────────
    function updateAllProgress() {
        // Overall
        const total = checkboxes.length;
        const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
        const percent = total > 0 ? Math.round((checked / total) * 100) : 0;
        document.getElementById('overall-progress').textContent = `${checked}/${total} (${percent}%)`;

        // Per section text
        document.querySelectorAll('.checklist-section').forEach(sec => {
            const cbInSec = sec.querySelectorAll('input[type="checkbox"]');
            const secTotal = cbInSec.length;
            const secChecked = Array.from(cbInSec).filter(c => c.checked).length;
            const progEl = sec.querySelector('.section-progress');
            if (progEl) progEl.textContent = `${secChecked}/${secTotal}`;
        });

        // Progress bars
        const container = document.getElementById('progress-bars-container');
        container.innerHTML = '';

        document.querySelectorAll('.checklist-section').forEach(sec => {
            const header = sec.querySelector('.section-header');
            const name = header.textContent.replace(/\d+\/\d+/g, '').trim();

            const cbInSec = sec.querySelectorAll('input[type="checkbox"]');
            const secTotal = cbInSec.length;
            const secChecked = Array.from(cbInSec).filter(c => c.checked).length;
            const secPercent = secTotal > 0 ? Math.round((secChecked / secTotal) * 100) : 0;

            const wrapper = document.createElement('div');
            wrapper.className = 'progress-bar-wrapper';

            const label = document.createElement('div');
            label.className = 'progress-bar-label';
            label.innerHTML = `<span>${name}</span><span>${secChecked}/${secTotal} (${secPercent}%)</span>`;

            const outer = document.createElement('div');
            outer.className = 'progress-bar-outer';

            const inner = document.createElement('div');
            inner.className = 'progress-bar-inner';
            inner.style.width = `${secPercent}%`;
            if (secPercent === 100) inner.classList.add('complete');

            outer.appendChild(inner);
            wrapper.appendChild(label);
            wrapper.appendChild(outer);
            container.appendChild(wrapper);
        });
    }

    // ────────────────────────────────
    // Export to JSON
    // ────────────────────────────────
    document.getElementById('export-json').addEventListener('click', () => {
        const data = {
            timestamp: new Date().toISOString(),
            customerName: document.getElementById('customer-name').value,
            assessor: document.getElementById('assessor').value,
            assessmentDate: document.getElementById('assessment-date').value,
            assessmentStatus: document.getElementById('assessment-status').value,
            context: document.getElementById('context').value,
            checkboxes: {}
        };

        checkboxes.forEach(cb => {
            const index = cb.getAttribute('data-index');
            data.checkboxes[index] = cb.checked;
        });

        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `cyber-assessment-${new Date().toISOString().slice(0,10)}.json`;
        a.click();
        URL.revokeObjectURL(url);
    });

    // ────────────────────────────────
    // Import from JSON
    // ────────────────────────────────
    const importInput = document.getElementById('import-file-input');
    document.getElementById('import-json').addEventListener('click', () => {
        importInput.click();
    });

    importInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(event) {
            try {
                const data = JSON.parse(event.target.result);

                // Restore fields
                if (data.customerName) document.getElementById('customer-name').value = data.customerName;
                if (data.assessor) document.getElementById('assessor').value = data.assessor;
                if (data.assessmentDate) document.getElementById('assessment-date').value = data.assessmentDate;
                if (data.assessmentStatus) document.getElementById('assessment-status').value = data.assessmentStatus;
                if (data.context) document.getElementById('context').value = data.context;

                // Restore checkboxes
                Object.entries(data.checkboxes || {}).forEach(([index, checked]) => {
                    const cb = document.querySelector(`input[type="checkbox"][data-index="${index}"]`);
                    if (cb) {
                        cb.checked = checked;
                        cb.nextElementSibling.classList.toggle('checked', checked);
                    }
                });

                // Save to localStorage for persistence
                fields.forEach(id => saveField(id));
                checkboxes.forEach(cb => saveCheckbox(cb));

                updateAllProgress();
                alert('Import successful!');
            } catch (err) {
                alert('Error importing file: Invalid JSON format\n\n' + err.message);
            }
        };
        reader.readAsText(file);
        e.target.value = ''; // reset input
    });

    // Initial load
    loadState();

    // Reset
    document.getElementById('reset-storage').addEventListener('click', () => {
        if (confirm('Clear ALL saved data (fields, notes, checkboxes)? This cannot be undone.')) {
            localStorage.clear();
            location.reload();
        }
    });
});
</script>
</body>
</html>
