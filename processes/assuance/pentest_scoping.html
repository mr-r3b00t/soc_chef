<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row =>
                    row.some(cell => cell !== '' && cell !== null && cell !== undefined)
                );

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penetration Testing Scoping Playbook</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            margin: 40px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            color: #333;
        }
        h1 {
            font-size: 2.2em;
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        h2 {
            font-size: 1.8em;
            color: #34495e;
            margin-top: 30px;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 5px;
        }
        h3 {
            font-size: 1.4em;
            color: #3c5a76;
            margin-top: 20px;
        }
        p {
            margin: 10px 0;
        }
        ul {
            list-style-type: none;
            padding-left: 20px;
        }
        ul li {
            margin: 8px 0;
            display: block;
        }
        input[type="checkbox"] {
            margin-right: 10px;
        }
        code {
            font-family: 'Consolas', monospace;
            background-color: #f5f6fa;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .section {
            margin-bottom: 20px;
        }
        .note {
            background-color: #e8f4f8;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 20px 0;
            border-radius: 5px;
        }
        #log-section {
            margin-top: 40px;
            padding: 20px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        #log-section h2 {
            margin-top: 0;
        }
        #log-list {
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 10px;
        }
        #log-list p {
            margin: 5px 0;
            font-size: 0.9em;
        }
        .button-container {
            display: flex;
            gap: 10px;
        }
        button {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
        }
        button:hover {
            background-color: #2980b9;
        }
        #clear-state-button {
            background-color: #e74c3c;
        }
        #clear-state-button:hover {
            background-color: #c0392b;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: inline-block;
            width: 120px;
            font-weight: bold;
        }
        .input-group input, .input-group textarea {
            padding: 5px;
            width: 200px;
            border: 1px solid #ddd;
            border-radius: 3px;
            vertical-align: top;
        }
        .input-group textarea {
            width: 300px;
            height: 60px;
            resize: vertical;
        }
        #timeline-error {
            color: #e74c3c;
            font-size: 0.9em;
            margin-top: 5px;
            display: none;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            font-size: 0.9em;
            color: #7f8c8d;
        }
        #jump-to-log {
            display: block;
            margin: 20px auto;
            text-align: center;
        }
        #user-info-section {
            padding: 20px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .copy-button {
            padding: 5px 10px;
            font-size: 0.9em;
            margin-left: 10px;
        }
        .copy-button.copied {
            background-color: #2ecc71;
        }
        .copy-button.copied:hover {
            background-color: #27ae60;
        }
        .email-template {
            background-color: #f9f9f9;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Consolas', monospace;
            font-size: 0.9em;
            line-height: 1.5;
            white-space: pre-wrap;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Penetration Testing Scoping Playbook</h1>
    <button id="jump-to-log">Jump to Action Log</button>

    <div id="user-info-section">
        <h2>User Information</h2>
        <div class="input-group">
            <label for="user-name">Name:</label>
            <input type="text" id="user-name" placeholder="Enter your name">
        </div>
        <div class="input-group">
            <label for="user-title">Title:</label>
            <input type="text" id="user-title" placeholder="Enter your title">
        </div>
        <div class="input-group">
            <label for="user-role">Role:</label>
            <input type="text" id="user-role" placeholder="Enter your role">
        </div>
        <div class="input-group">
            <label for="user-org">Organisation:</label>
            <input type="text" id="user-org" placeholder="Enter your organisation">
        </div>
    </div>

    <div class="section">
        <h2>Executive Summary</h2>
        <p>This playbook outlines a structured process for scoping a penetration test to ensure clear objectives, well-defined boundaries, and actionable outcomes. It guides security consultants through client engagement, scope definition, methodology selection, constraints identification, deliverables planning, and post-scoping activities. The process is designed to align with client needs, comply with legal and ethical standards, and deliver measurable value through thorough preparation and documentation.</p>
    </div>

    <div class="section">
        <h2>Scoping Checklist</h2>
        <p>The following checklist summarizes key actions to complete during the pentest scoping process.</p>
        <ul>
            <li><input type="checkbox" id="engagement" data-label="Client Engagement">Client Engagement
                <ul>
                    <li><input type="checkbox" id="engagement-contact" data-label="Identify contact">Identify primary client contact.</li>
                    <li><input type="checkbox" id="engagement-objectives" data-label="Define objectives">Define client objectives.</li>
                    <li><input type="checkbox" id="engagement-legal" data-label="Confirm legal">Confirm legal authorization.</li>
                </ul>
            </li>
            <li><input type="checkbox" id="scope-definition" data-label="Scope Definition">Scope Definition
                <ul>
                    <li><input type="checkbox" id="scope-assets" data-label="List assets">List in-scope assets.</li>
                    <li><input type="checkbox" id="scope-boundaries" data-label="Set boundaries">Set scope boundaries.</li>
                    <li><input type="checkbox" id="scope-approval" data-label="Client approval">Obtain client approval.</li>
                </ul>
            </li>
            <li><input type="checkbox" id="methodology" data-label="Methodology Selection">Methodology Selection
                <ul>
                    <li><input type="checkbox" id="methodology-types" data-label="Select test types">Select test types.</li>
                    <li><input type="checkbox" id="methodology-tools" data-label="Choose tools">Choose testing tools.</li>
                    <li><input type="checkbox" id="methodology-align" data-label="Align with client">Align methodology with client needs.</li>
                </ul>
            </li>
            <li><input type="checkbox" id="constraints" data-label="Constraints Identification">Constraints Identification
                <ul>
                    <li><input type="checkbox" id="constraints-time" data-label="Define time">Define time constraints.</li>
                    <li><input type="checkbox" id="constraints-technical" data-label="Identify technical">Identify technical limitations.</li>
                    <li><input type="checkbox" id="constraints-document" data-label="Document constraints">Document all constraints.</li>
                </ul>
            </li>
            <li><input type="checkbox" id="deliverables" data-label="Deliverables Planning">Deliverables Planning
                <ul>
                    <li><input type="checkbox" id="deliverables-report" data-label="Plan report">Plan report format.</li>
                    <li><input type="checkbox" id="deliverables-presentation" data-label="Plan presentation">Plan client presentation.</li>
                    <li><input type="checkbox" id="deliverables-confirm" data-label="Confirm deliverables">Confirm deliverables with client.</li>
                </ul>
            </li>
            <li><input type="checkbox" id="post-scoping" data-label="Post-Scoping Activities">Post-Scoping Activities
                <ul>
                    <li><input type="checkbox" id="post-scoping-finalize" data-label="Finalize scope">Finalize scope document.</li>
                    <li><input type="checkbox" id="post-scoping-kickoff" data-label="Schedule kickoff">Schedule test kickoff.</li>
                    <li><input type="checkbox" id="post-scoping-archive" data-label="Archive records">Archive scoping records.</li>
                </ul>
            </li>
        </ul>
    </div>

    <div class="section">
        <h2>1. Client Engagement</h2>
        <p>Establish clear communication and alignment with the client to set the foundation for the pentest.</p>

        <h3>Identify Primary Client Contact</h3>
        <ul>
            <li>Confirm the primary point of contact for scoping discussions.</li>
            <li>Document their name, role, and contact details (e.g., email, phone).</li>
        </ul>

        <h3>Define Client Objectives</h3>
        <ul>
            <li>Discuss and document the client’s goals (e.g., compliance, vulnerability identification, resilience testing).</li>
            <li>Clarify whether the pentest is driven by specific risks, regulations, or business needs.</li>
        </ul>

        <h3>Confirm Legal Authorization</h3>
        <ul>
            <li>Obtain written authorization from the client to conduct the pentest.</li>
            <li>Ensure the agreement specifies the scope, timeline, and legal protections.</li>
            <li>Verify compliance with relevant laws (e.g., GDPR, HIPAA if applicable).</li>
        </ul>
    </div>

    <div class="section">
        <h2>2. Scope Definition</h2>
        <p>Define the boundaries and targets of the penetration test to ensure focus and clarity.</p>

        <h3>List In-Scope Assets</h3>
        <ul>
            <li>Identify systems, networks, applications, or devices to be tested (e.g., IP ranges, URLs, APIs).</li>
            <li>Document asset details, including ownership and criticality.</li>
        </ul>

        <h3>Set Scope Boundaries</h3>
        <ul>
            <li>Specify out-of-scope assets to avoid unintended impacts (e.g., third-party systems, production servers).</li>
            <li>Define testing conditions (e.g., black-box, gray-box, white-box).</li>
        </ul>

        <h3>Obtain Client Approval</h3>
        <ul>
            <li>Share the draft scope with the client for review.</li>
            <li>Address feedback and obtain formal sign-off on the scope document.</li>
            <li>Send a confirmation email to the client contact. Example:
                <div class="email-template" id="email-template">
Subject: Confirmation of Penetration Test Scope for [Client Name]

Dear [Client Contact],

We have finalized the scope for the upcoming penetration test scheduled for [start date]. The scope includes:

- In-Scope Assets: [e.g., IP range 192.168.1.0/24, web app at example.com]
- Out-of-Scope Assets: [e.g., third-party cloud services]
- Test Type: [e.g., gray-box, external network]
- Timeline: [e.g., scoping completed by DD/MM/YYYY, testing from DD/MM/YYYY]

Please confirm your approval or provide any feedback by [response deadline]. Let us know if you need further details or coordination.

Best regards,
[Your Name]
[Your Organization]
[Contact Information]
                </div>
                <button id="copy-email-template" class="copy-button">Copy to Clipboard</button>
            </li>
            <li>Log the confirmation and retain a copy for records.</li>
        </ul>
    </div>

    <div class="section">
        <h2>3. Methodology Selection</h2>
        <p>Select the appropriate testing methodologies to align with client objectives and scope.</p>

        <h3>Select Test Types</h3>
        <ul>
            <li>Determine the types of tests (e.g., network, web application, social engineering, physical).</li>
            <li>Align test types with client goals and asset types.</li>
        </ul>

        <h3>Choose Testing Tools</h3>
        <ul>
            <li>Identify tools for scanning, exploitation, and reporting (e.g., open-source, commercial).</li>
            <li>Ensure tools comply with legal and client requirements.</li>
        </ul>

        <h3>Align Methodology with Client Needs</h3>
        <ul>
            <li>Discuss methodology with the client to confirm expectations (e.g., non-disruptive testing).</li>
            <li>Document the agreed methodology, including tools and techniques.</li>
        </ul>
    </div>

    <div class="section">
        <h2>4. Constraints Identification</h2>
        <p>Identify limitations that may impact the pentest to ensure realistic planning.</p>

        <h3>Define Time Constraints</h3>
        <ul>
            <li>Confirm the testing window (e.g., specific dates, hours).</li>
            <li>Document any restrictions (e.g., no testing during business hours).</li>
        </ul>

        <h3>Identify Technical Limitations</h3>
        <ul>
            <li>Note restrictions on testing methods (e.g., no DoS attacks, no password guessing).</li>
            <li>Identify systems with limited access or special configurations.</li>
        </ul>

        <h3>Document All Constraints</h3>
        <ul>
            <li>Compile a list of time, technical, and other constraints (e.g., regulatory).</li>
            <li>Share constraints with the client to confirm agreement.</li>
        </ul>
    </div>

    <div class="section">
        <h2>5. Deliverables Planning</h2>
        <p>Plan the outputs of the pentest to meet client expectations.</p>

        <h3>Plan Report Format</h3>
        <ul>
            <li>Define the structure of the pentest report (e.g., executive summary, findings, recommendations).</li>
            <li>Specify formats (e.g., PDF, Word) and delivery methods.</li>
        </ul>

        <h3>Plan Client Presentation</h3>
        <ul>
            <li>Schedule a presentation to discuss findings (e.g., in-person, virtual).</li>
            <li>Outline key points to cover (e.g., critical vulnerabilities, remediation steps).</li>
        </ul>

        <h3>Confirm Deliverables with Client</h3>
        <ul>
            <li>Review planned deliverables with the client for alignment.</li>
            <li>Document any additional requirements (e.g., raw data, compliance forms).</li>
        </ul>
    </div>

    <div class="section">
        <h2>6. Post-Scoping Activities</h2>
        <p>Finalize preparations and transition to the testing phase.</p>

        <h3>Finalize Scope Document</h3>
        <ul>
            <li>Compile all scoping details into a final document.</li>
            <li>Obtain client sign-off on the finalized scope.</li>
        </ul>

        <h3>Schedule Test Kickoff</h3>
        <ul>
            <li>Arrange a kickoff meeting with the client and testing team.</li>
            <li>Confirm communication protocols for during the test.</li>
        </ul>

        <h3>Archive Scoping Records</h3>
        <ul>
            <li>Store all scoping documents (e.g., agreements, emails) securely.</li>
            <li>Ensure records are accessible for audits or future reference.</li>
        </ul>
    </div>

    <div class="section">
        <h2>Additional Notes</h2>
        <div class="note">
            <ul>
                <li><strong>Preserve Evidence:</strong> Maintain records of scoping decisions for legal and audit purposes.</li>
                <li><strong>Leverage Automation:</strong> Use scoping templates to streamline future engagements.</li>
                <li><strong>Engage Experts:</strong> Consult specialists for complex environments or compliance needs.</li>
                <li><strong>Continuous Communication:</strong> Keep the client informed to avoid misunderstandings.</li>
                <li><strong>Ethical Considerations:</strong> Ensure all actions comply with legal and ethical standards.</li>
            </ul>
        </div>
        <p>This playbook aligns with industry best practices for penetration test scoping, ensuring a clear, compliant, and client-focused process.</p>
    </div>

    <div id="log-section">
        <h2>Action Log</h2>
        <div class="input-group">
            <label for="timeline-alt-name">Alternative Name:</label>
            <input type="text" id="timeline-alt-name" placeholder="Enter alternative name (optional)">
        </div>
        <div class="input-group">
            <label for="timeline-activity">Timeline Entry:</label>
            <textarea id="timeline-activity" placeholder="Enter activity description"></textarea>
            <button id="add-timeline" style="margin-left: 10px;">Add Timeline Entry</button>
        </div>
        <p id="timeline-error">Please enter a name (either in User Information or Alternative Name) to add a timeline entry.</p>
        <div id="log-list"></div>
        <div class="button-container">
            <button id="export-log">Export Log</button>
            <button id="clear-state-button">Clear State</button>
        </div>
    </div>

    <div class="footer">
        <p>© Xservus Limited</p>
    </div>

    <script>
        // Initialize log array
        let logEntries = [];

        // Load user info from local storage
        function loadUserInfo() {
            document.getElementById('user-name').value = localStorage.getItem('pentestChecklistUserName') || '';
            document.getElementById('user-title').value = localStorage.getItem('pentestChecklistUserTitle') || '';
            document.getElementById('user-role').value = localStorage.getItem('pentestChecklistUserRole') || '';
            document.getElementById('user-org').value = localStorage.getItem('pentestChecklistUserOrg') || '';
            document.getElementById('timeline-alt-name').value = localStorage.getItem('pentestChecklistTimelineAltName') || '';
        }

        // Save user info to local storage
        function saveUserInfo() {
            localStorage.setItem('pentestChecklistUserName', document.getElementById('user-name').value);
            localStorage.setItem('pentestChecklistUserTitle', document.getElementById('user-title').value);
            localStorage.setItem('pentestChecklistUserRole', document.getElementById('user-role').value);
            localStorage.setItem('pentestChecklistUserOrg', document.getElementById('user-org').value);
            localStorage.setItem('pentestChecklistTimelineAltName', document.getElementById('timeline-alt-name').value);
        }

        // Load checkbox states from local storage
        function loadCheckboxStates() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                const state = localStorage.getItem(checkbox.id);
                if (state === 'checked') {
                    checkbox.checked = true;
                }
            });
        }

        // Save checkbox state to local storage
        function saveCheckboxState(checkbox) {
            localStorage.setItem(checkbox.id, checkbox.checked ? 'checked' : 'unchecked');
        }

        // Get user info for log entry
        function getUserInfo() {
            const name = document.getElementById('user-name').value || 'Unknown';
            const title = document.getElementById('user-title').value || 'N/A';
            const role = document.getElementById('user-role').value || 'N/A';
            const org = document.getElementById('user-org').value || 'N/A';
            return { name, title, role, org };
        }

        // Add checkbox log entry
        function addCheckboxLogEntry(checkbox, action) {
            const timestamp = new Date().toLocaleString();
            const { name, title, role, org } = getUserInfo();
            const label = checkbox.dataset.label;
            const entry = `[${timestamp}] ${name} (${title}, ${role}, ${org}) - ${label} ${action}`;
            logEntries.push(entry);
            updateLogDisplay();
        }

        // Add timeline log entry
        function addTimelineLogEntry() {
            const nameInput = document.getElementById('user-name');
            const altNameInput = document.getElementById('timeline-alt-name');
            const activityInput = document.getElementById('timeline-activity');
            const errorDisplay = document.getElementById('timeline-error');

            if (!nameInput.value.trim() && !altNameInput.value.trim()) {
                errorDisplay.style.display = 'block';
                return false;
            }

            errorDisplay.style.display = 'none';
            const timestamp = new Date().toLocaleString();
            const { title, role, org } = getUserInfo();
            const name = altNameInput.value.trim() || nameInput.value.trim() || 'Unknown';
            const activity = activityInput.value.trim() || 'No description provided';
            const entry = `[${timestamp}] ${name} (${title}, ${role}, ${org}) - Timeline Entry: ${activity}`;
            logEntries.push(entry);
            updateLogDisplay();
            activityInput.value = ''; // Clear the textarea
            altNameInput.value = ''; // Clear the alternative name
            saveUserInfo();
            return true;
        }

        // Update log display
        function updateLogDisplay() {
            const logList = document.getElementById('log-list');
            logList.innerHTML = logEntries.map(entry => `<p>${entry}</p>`).join('');
            logList.scrollTop = logList.scrollHeight; // Scroll to bottom
            localStorage.setItem('pentestChecklistLog', JSON.stringify(logEntries));
        }

        // Export log as text file
        function exportLog() {
            const { name, title, role, org } = getUserInfo();
            const header = `Pentest Scoping Playbook Log\nUser: ${name}\nTitle: ${title}\nRole: ${role}\nOrganisation: ${org}\nGenerated: ${new Date().toLocaleString()}\n\n`;
            const footer = `\nCreated using the PwnDefend Pentest Scoping Playbook - copyright (c) xservus limited`;
            const content = header + logEntries.join('\n') + footer;
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Pentest_Scoping_Log_${new Date().toISOString().replace(/[:.]/g, '-')}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Clear checkbox states, user info, timeline entries, and log
        function clearState() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
                localStorage.setItem(checkbox.id, 'unchecked');
            });
            document.getElementById('user-name').value = '';
            document.getElementById('user-title').value = '';
            document.getElementById('user-role').value = '';
            document.getElementById('user-org').value = '';
            document.getElementById('timeline-alt-name').value = '';
            document.getElementById('timeline-activity').value = '';
            localStorage.removeItem('pentestChecklistUserName');
            localStorage.removeItem('pentestChecklistUserTitle');
            localStorage.removeItem('pentestChecklistUserRole');
            localStorage.removeItem('pentestChecklistUserOrg');
            localStorage.removeItem('pentestChecklistTimelineAltName');
            logEntries = [];
            updateLogDisplay();
            document.getElementById('timeline-error').style.display = 'none';
        }

        // Initialize event listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved log entries
            const savedLog = localStorage.getItem('pentestChecklistLog');
            if (savedLog) {
                logEntries = JSON.parse(savedLog);
                updateLogDisplay();
            }

            // Load user info and checkbox states
            loadUserInfo();
            loadCheckboxStates();

            // User info input listeners
            ['user-name', 'user-title', 'user-role', 'user-org', 'timeline-alt-name'].forEach(id => {
                document.getElementById(id).addEventListener('input', saveUserInfo);
            });

            // Checkbox event listeners
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    saveCheckboxState(checkbox);
                    addCheckboxLogEntry(checkbox, checkbox.checked ? 'checked' : 'unchecked');
                });
            });

            // Timeline entry button
            document.getElementById('add-timeline').addEventListener('click', () => {
                if (addTimelineLogEntry()) {
                    localStorage.setItem('pentestChecklistLog', JSON.stringify(logEntries));
                }
            });

            // Export log button
            document.getElementById('export-log').addEventListener('click', exportLog);

            // Clear state button
            document.getElementById('clear-state-button').addEventListener('click', clearState);

            // Jump to Action Log button
            document.getElementById('jump-to-log').addEventListener('click', () => {
                document.getElementById('log-section').scrollIntoView({ behavior: 'smooth' });
            });

            // Copy to Clipboard button for email template
            const copyButton = document.getElementById('copy-email-template');
            if (copyButton) {
                copyButton.addEventListener('click', () => {
                    const queryText = document.getElementById('email-template').textContent;
                    navigator.clipboard.writeText(queryText).then(() => {
                        copyButton.textContent = 'Copied!';
                        copyButton.classList.add('copied');
                        setTimeout(() => {
                            copyButton.textContent = 'Copy to Clipboard';
                            copyButton.classList.remove('copied');
                        }, 2000);
                    });
                });
            }
        });
    </script>
</body>
</html>
